<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="description"
    content="The financial transactions database to power the next 30 years of Online Transaction Processing.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@TigerBeetleDB">
  <meta name="twitter:author" content="@TigerBeetleDB">
  <meta name="twitter:description"
    content="The financial transactions database to power the next 30 years of Online Transaction Processing.">
  <meta name="twitter:title" content="$title">
  <meta name="twitter:image" content="https://docs.tigerbeetle.com/img/preview.webp">
  <meta property="og:type" content="website">
  <meta property="og:title" content="$title">
  <meta property="og:image" content="https://docs.tigerbeetle.com/img/preview.webp">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="author" content="$author">
  <title id="title">Page not found | TigerBeetle</title>
  <link rel="icon" href="$url_prefix/img/favicon.png">
  <link rel="stylesheet" type="text/css" href="$url_prefix/style/style.css">
  <style>
    article>.content {
      padding: 0;
      height: 100vh;
    }

    section.four-oh-four {
      display: flex;
      flex-direction: column;
      gap: 30px;
      text-align: center;
      margin: auto;
    }

    canvas {
      width: 600px;
      max-width: 100vw;
      image-rendering: pixelated;
    }

    #resources {
      display: none;

      img {
        image-rendering: pixelated;
      }
    }
  </style>
</head>

<body>
  <main>
    <article>
      <div class="content">
        <section class="four-oh-four">
          <canvas width="600" height="150"></canvas>
          <h2>Page not found</h2>
          <p>Take me <a href="/">home</a>, country roads...</p>
        </section>
        <div id="resources">
          <img id="fontb" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABAAQMAAADoGO08AAAABlBMVEUAAAAAAAClZ7nPAAAAAXRSTlMAQObYZgAAAdJJREFUeF7N0qGO20AQBuAB1SrAwNDgwMLCgQanU8oKDQsKDAsCDKoqqkZWHqCv0LK+QlU4oPrRKiqKgk5FB6Ogk8HK6symd6eklSoV9Wf+NJ5/1zLli1C6yD/A70v/mv/mHNR01BH19fIB2q5bvxyix2BhQNP3r/tljJNDQzRQNw1vKZrQREzU0/Tqzd5giORPlu7Y+UQXe+pttZqYeku0AYfHlGZhkTTLLFJMCAOQNghA3zfEoC2HkLJWDjw1gXZ8fZ1CbmT0zqqiO+7DHNAilImGwIoKBuij7fCWWSqRVsRbXZ6yKXAjWfI8C3iGAkIvYFEFOCQ93IE+AmqgBnud70GfkRU5b2cOR93dGsxlAmUCW9Cnxx1IxqAlvEUFLMjeckMXyX4OACnldtMawMIFPkRd1AXUYZ2a2C+eFxCDHa858sJ33ObAWM1rtus7aEpgtIfE3+KiwHsIS43EuaWWhP4QpUBXpFwpO8QC/AT1mGUUHjORrclCBE8GuNrzF8BBMbNBOp5gCyMeDX5N3NuOkQN4nQwez3H+B/MJm5rPIdbltuN+zPBkg8FbJ2Vgt0KzrJ+9dvgh/j3akR9e0cDb9rAK/Qk0aL56VwOSvcWBzvIT9ibJYPzvOOUAAAAASUVORK5CYII=">
          <img id="fontw" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABAAgMAAACvuJfsAAAADFBMVEUAAAD////////9/f3nfOxoAAAAAnRSTlMA/bWfQ5kAAAJsSURBVHja7ZO9ilRBEIXPNl64dLQLs/kwUVGRgZFsMIIPcIV9AAN9jwploxHcZKOzgytNP4PBPsqgmfoQTvUPc3HZURCMPE1d+uejqs50DzKPD/C4/gnw2yb/Xv9/h66T9RmAFVzPELDELxr2wApqS1M8wdhGkxUAyLbFlW3taTnM1oHgwHkpkE2hS2BsCEpEpxbwxcrEtlYBRc8gcNUM++gZVvu4AHBRG54aUtVdjAVABx7qFE06RSiVZE5aQnnAlNgsFBQKaaBAfC6QYjD6zuYyAn7ATALsQES2YBC8X0RERpKQzGBKTegGCeLDIvpCcvL00SiYZQiGzR6g1yIb4CXG2kN34b2DSmU0/3aTjjyi9QEYLpWZHjl5Jopn3AmLeSVOTyhtoG667R2JlJJQ8OJVPWwAKvDFiJyyAy/PKJmEfzOZcnLgG4itbFMBcpplkJ6hzJOX+PiwB5Ye6i5OQekuiOpCuZPM5mJ4g+PKVNZohUhmRjNEg6t3EHEAjCMIWJgB6IAaGWyEADYaOqCswNZbtIgREbDWwzZlopQQ5uTH9bobQNBVgGgp0XMtR+AA6LtaQhlAccBdAB5K/JHYXmnY+DwCEzGgaZwBAxrAGRCg6Y5KTcoBmj4VmtOAG15P55MvpI+3U7vu6XY94Eo2i82iA6DkNKAC03SHOZBaBniJCtzaDMiSaw9pAEqG8zWnWACdHlw+HlPEXMEC4jFgROi3eT09//z1XlN+fbCbWQF1YLPYXXy/J/p7EFKCLR1YrtiAH1D29xBNU5yXuNmX2KE8mOTvQQiRObABLnbIDFQJ7R+d2Vx04NhT+Ams/j80neoPTgAAAABJRU5ErkJggg==">
          <img id="bgtilesb" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAYCAYAAABKtPtEAAAAO0lEQVR4Ae3UAQYAIBREwe5/6Q2oEJAof4YVIB7VgFUEmBFSLXJ2u3bHQ1J8AnAo4wTwJwgA3rYAAF/olNaXaZ3eoTUAAAAASUVORK5CYII=">
          <img id="bgtilesw" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAYAQAAAABiz8bpAAAAAnRSTlMAAHaTzTgAAAAsSURBVHgBY8ADBGAMKQYGDjDDnoFBBsz4DwUIBhJYwEAYcCEYBIEGgkE0AABP5BGCOTOf8AAAAABJRU5ErkJggg==">
          <img id="beetle" src="data:image/png;base64,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">
          <img id="bug" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAAAoAgMAAADyLsu6AAAADFBMVEUAAAAAAAAprf////9DRhisAAAAAXRSTlMAQObYZgAABCtJREFUeF6tlbFu5DYQhgWoJu5pWPspZokoOqhysTocLOCwXRZ+CsVPQBxEY3HVlYEJuHZJGQjSps426jbHzAxFjSzAiRF4KmLB/+M3JJcq/lfFeC7esz4ANO+AlrAGAC/oN2X/1St8egidoN/gWoJHwCWjNl7lzrnfakG/wVUBCmiTURsvVTl3bwQtrq8C9REFgkx4GVatc+5Z0OL6OvC+RsAkE16ENQF7v6A3rtsqI0YcAquTAJcw7bx2WN+9oBfXDemSgtip3hNwEOASBrTQvzpnrwkjaHGVUiYFoaND2QBzGAyO+v0A1z4KWlzXpdMhBNyKEmKMO7sC5vBN8AgEAPsIPqPLs7iuKkzdVbwUIx5IEQOYzSmn8MOEGAuws0/HbkZ7VYvrqsbTF8T40SFQAcDBMIgWoUphBn4NDQIfuhnt1R/ZtVhHxuGIkY6BuvprahhUoiubcngD5BEZZtdiHQn2gJg6DAgMzn1jQXblvUzhb38icKj6yj7tF2B5zq4vIhoYo6Hja+pCEqNFBNj2fj7RR8hon5fjkUSUYcwTTiyr+cyya8xhMHTnvo7urohyWdZAaa+MjHmMJN229rqj39j1Ea3lYquqB0eJjMYS11V7ioB8+dT1TxV87siaXZ+gpvDv7i6eKdEDbbSg1665vegRg16fGbgHMAOONPAihxuDYbtL4SLkg1qhEciu2esLdMlrn4DGNgQMEy9ycM8YHnbD9u0L17u+SxT0Nyz4N7FPR6jFq1CfmtMtjcYTL3KgxUPr+s3rfDXJK26r2RXIYY9NiRc28OP+x9BFPw68CAHF68M5fz/CbUbLchpmh2fxStYDbkOwvMihNSsvXS+fnjrG6Gl0WZYLU3bIXnxrhskNuA0aeBHakCu/eBl6hbFUgyPglsyy3HhiBwYmr4jWrUUmboMCXoSOLHTZywSv2Ea12BbU3KcnVwYO5MBNpUaP4MNUIdDiNiiYf6tLCqb2qu9eJ6/2rtA3Jj197EpDyw4cqbBRe4BuPDFwcneageQq7ZWV9YE/SKoyhXbP3Gc3uxZzBKBTwBicOw70OPQIDBMtQq7SHt5mT68wHwoC77jPbnZFLl9sMF4fdwjscW6wgECjWyOu0h4dyujYJnQzMFgapQ9qYODPwet7xuBcDVPlbK2AXBFIrtJeoesMvKK3zKRDITQDzW4A17e40Q4Ig0Bl+I0soRNXaQ8vdsGvMFfaBoXUDKx6dMC2vN5/JAzOLS/pFY9eXKW9/K3lygd1KdiVgRYjHxGo4BYxF55bxnSLk+svmJL22Eu+iNGLa36BsKrelzBBnAzPVWhaL38pgymJcCoWUuK6PG4cKmJADDxGbqmBZBPI20vktRJXXfUxDFCT7NDsLGeCI+dCfpPIf5Z21o+uOfPb3VQDh0c8d8tA+Y3rzcC6eCfgP0K6h/+J1dO6AAAAAElFTkSuQmCC">
        </div>
      </div>
    </article>
  </main>
  <script>
    const fontb = document.querySelector("img#fontb");
    const fontw = document.querySelector("img#fontw");
    const bgtilesb = document.querySelector("img#bgtilesb");
    const bgtilesw = document.querySelector("img#bgtilesw");
    const beetle = document.querySelector("img#beetle");
    const bug = document.querySelector("img#bug");
    const canvas = document.querySelector("canvas");
    canvas.onpointerdown = onAction;
    const ctx = canvas.getContext("2d");
    ctx.imageSmoothingEnabled = false;

    requestAnimationFrame(draw);

    const STATE_INIT = 0;
    const STATE_GAME = 1;
    const STATE_OVER = 2;
    const SPEED_MIN = 200;
    const SPEED_MAX = 1000;

    let highscore = 0;
    let gamestate = STATE_INIT;
    let distance = 0;
    let jumping = false;
    let playery = 0;
    let playerdy = 0;
    let gameovertime = 0;

    let oldTime = performance.now() / 1000;
    function draw() {
      requestAnimationFrame(draw);

      const time = performance.now() / 1000;
      const deltaTime = time - oldTime;
      oldTime = time;

      const score = int(distance / 10);
      const speed = Math.min(SPEED_MAX, SPEED_MIN + int(score / 100) * 10);
      if (gamestate == STATE_GAME) {
        distance += speed * deltaTime;
      }

      if (gamestate == STATE_GAME || gamestate == STATE_OVER) {
        if (jumping) {
          playerdy -= 1000 * deltaTime;
          playery += playerdy * deltaTime;
          if (playery < 0) {
            jumping = false;
            playery = 0;
            playerdy = 0;
          }
        }
      }

      const bugtype = rand(int(distance / 700)) < 0.7 ? 0 : 1;
      let bugframe = int(time * 10) % 4 + 4 * bugtype;
      const bugx = 600 - (distance % 700);
      const bugy = 86 - 60 * bugtype;

      const playerbox = { x: 5, y: 86 - playery + 7, w: 34, h: 28 };
      const bugbox = bugtype ?
        { x: bugx + 4, y: bugy + 2, w: 24, h: 32 } :
        { x: bugx + 2, y: bugy + 12, w: 32, h: 28 };
      if (gamestate == STATE_GAME && overlap(playerbox, bugbox)) {
        gamestate = STATE_OVER;
        gameovertime = time;
      }

      let playerframe = int(time * 10) % 4;
      if (gamestate == STATE_GAME) {
        playerframe = int(time * speed / 20) % 4 + 4;
        if (jumping) playerframe = playerdy > 0 ? 4 : playery > 60 ? 5 : 6;
      } else if (gamestate == STATE_OVER) {
        playerframe += 10;
        const hurttime = time - gameovertime;
        if (hurttime < 0.3 || jumping) playerframe = int(hurttime * 10) % 2 + 8;
        bugframe = 4 * bugtype + 1;
      }

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const bgtiles = isDarkmode() ? bgtilesw : bgtilesb;
      for (let i = int(distance / 32), x = -distance % 32; x < 600; x += 32, i++) {
        ctx.drawImage(bgtiles, rand(i) < 0.75 ? 0 : 32, 0, 32, 24, x, 150 - 40, 32, 24);
      }
      ctx.drawImage(bug, 40 * bugframe, 0, 40, 40, bugx, bugy, 40, 40);
      ctx.drawImage(beetle, 40 * playerframe, 0, 40, 40, 0, 86 - playery, 40, 40);

      let scorestr = String(score).padStart(5, "0");
      if (highscore) scorestr = "HI " + String(highscore).padStart(5, "0") + " " + scorestr;
      drawText(scorestr, 600 - scorestr.length * 8, 0, 1);
      if (gamestate == STATE_GAME) {
        if (score >= 100 && score < 8000 && score % 100 < 20 && score & 2) {
          drawText("SPEED UP", 600 - 64, 12, 1);
        }
      } else if (gamestate == STATE_OVER) {
        drawText("G A M E   O V E R", 300 - 17 * 8, 75 - 8, 2);
      }
    }

    function onAction(e) {
      e.preventDefault();
      if (gamestate == STATE_INIT) {
        gamestate = STATE_GAME;
      } else if (gamestate == STATE_GAME) {
        if (!jumping) {
          jumping = true;
          playerdy = 400;
        }
      } else if (gamestate == STATE_OVER) {
        gamestate = STATE_INIT;
        const score = int(distance / 10);
        if (score > highscore) highscore = score;
        distance = 0;
        jumping = false;
        playery = 0;
        playerdy = 0;
      }
    }

    function drawText(text, x, y, s) {
      const font = isDarkmode() ? fontw : fontb;
      for (let i = 0; i < text.length; i++) {
        const code = text.charCodeAt(i);
        ctx.drawImage(font, code % 16 * 8, int(code / 16) * 8, 8, 8, x + s * 8 * i, y, s * 8, s * 8);
      }
    }

    function overlap(b1, b2) {
      return b1.x < b2.x + b2.w && b1.x + b1.w > b2.x && b1.y < b2.y + b2.h && b1.y + b1.h > b2.y;
    }

    function int(x) {
      return Math.floor(x);
    }

    function hash32(i) {
      return (i * 2654435761) >>> 0;
    }

    function rand(seed) {
      return hash32(seed) / 0xffffffff;
    }

    function isDarkmode() {
      return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    }
  </script>
</body>

</html>
